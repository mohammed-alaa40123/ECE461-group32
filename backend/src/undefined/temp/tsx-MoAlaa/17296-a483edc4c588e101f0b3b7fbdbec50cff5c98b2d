{"code":"(()=>{\n\"use strict\";var __defProp=Object.defineProperty;var __getOwnPropDesc=Object.getOwnPropertyDescriptor;var __getOwnPropNames=Object.getOwnPropertyNames;var __hasOwnProp=Object.prototype.hasOwnProperty;var __name=(target,value)=>__defProp(target,\"name\",{value,configurable:true});var __export=(target,all)=>{for(var name in all)__defProp(target,name,{get:all[name],enumerable:true})};var __copyProps=(to,from,except,desc)=>{if(from&&typeof from===\"object\"||typeof from===\"function\"){for(let key of __getOwnPropNames(from))if(!__hasOwnProp.call(to,key)&&key!==except)__defProp(to,key,{get:()=>from[key],enumerable:!(desc=__getOwnPropDesc(from,key))||desc.enumerable})}return to};var __toCommonJS=mod=>__copyProps(__defProp({},\"__esModule\",{value:true}),mod);var netScore_exports={};__export(netScore_exports,{calculateNetScore:()=>calculateNetScore});module.exports=__toCommonJS(netScore_exports);var import_license=require(\"./license\");var import_rampUp=require(\"./rampUp\");var import_responsiveMaintainer=require(\"./responsiveMaintainer\");var import_correctness=require(\"./correctness\");var import_processURL=require(\"../processURL\");var import_busFactor=require(\"./busFactor\");var import_logger=require(\"../logger\");var import_util=require(\"util\");var import_child_process=require(\"child_process\");var import_util2=require(\"../util\");const logger=(0,import_logger.getLogger)();async function calculateNetScore(linkPath,repoInfo){let results=[];if(linkPath){results=await(0,import_processURL.processURLs)(linkPath)}else if(repoInfo){results=[{packageName:repoInfo.repo,owner:repoInfo.owner,url:repoInfo.url}]}for(const{packageName,owner,url}of results){const netStart=Date.now();const repoDir=await(0,import_util2.cloneRepo)(`https://github.com/${owner}/${packageName}.git`,packageName);let totalLinesCorrectness=0;let totalLinesRamp=0;if(repoDir){try{const execAsync=(0,import_util.promisify)(import_child_process.exec);const{stdout}=await execAsync(`npx cloc --json ${repoDir}`);const clocData=JSON.parse(stdout);const jsLines=clocData.JavaScript?.code||0;const tsLines=clocData.TypeScript?.code||0;totalLinesCorrectness=jsLines+tsLines;totalLinesRamp=clocData.SUM?.code||0}catch(error){logger.info(`Error calculating lines of code: ${error}`)}}const[licenseScoreResult,rampUpScoreResult,responsiveMaintainerScoreResult,busFactorResult,correctnessResult]=await Promise.all([calculateWithLatency(()=>(0,import_license.calculateLicenseScore)(owner,packageName,repoDir)),calculateWithLatency(()=>(0,import_rampUp.calculateRampUpScore)(owner,packageName,repoDir,totalLinesRamp)),calculateWithLatency(()=>(0,import_responsiveMaintainer.calculateResponsiveMaintainerScore)(owner,packageName)),calculateWithLatency(()=>(0,import_busFactor.calculateBusFactorScore)(owner,packageName)),calculateWithLatency(()=>(0,import_correctness.calculateCorrectness)(repoDir,totalLinesCorrectness))]);const{score:licenseScore,latency:licenseLatency}=licenseScoreResult;const{score:rampUpScore,latency:rampUpLatency}=rampUpScoreResult;const{score:responsiveMaintainerScore,latency:responsiveMaintainerLatency}=responsiveMaintainerScoreResult;const{score:busFactor,latency:busFactorLatency}=busFactorResult;const{score:correctness,latency:correctnessLatency}=correctnessResult;const netScore=.3*licenseScore+.1*rampUpScore+.15*responsiveMaintainerScore+.15*busFactor+.3*correctness;const netEnd=Date.now();const netLatency=(netEnd-netStart)/1e3;logger.console(JSON.stringify({URL:url.trim(),NetScore:parseFloat(netScore.toFixed(2)),NetScore_Latency:parseFloat(netLatency.toFixed(3)),RampUp:parseFloat(rampUpScore.toFixed(2)),RampUp_Latency:parseFloat(rampUpLatency.toFixed(3)),Correctness:parseFloat(correctness.toFixed(2)),Correctness_Latency:parseFloat(correctnessLatency.toFixed(3)),BusFactor:parseFloat(busFactor.toFixed(2)),BusFactor_Latency:parseFloat(busFactorLatency.toFixed(3)),ResponsiveMaintainer:parseFloat(responsiveMaintainerScore.toFixed(2)),ResponsiveMaintainer_Latency:parseFloat(responsiveMaintainerLatency.toFixed(3)),License:parseFloat(licenseScore.toFixed(2)),License_Latency:parseFloat(licenseLatency.toFixed(3))}));return{URL:url.trim(),NetScore:parseFloat(netScore.toFixed(2)),NetScore_Latency:parseFloat(netLatency.toFixed(3)),RampUp:parseFloat(rampUpScore.toFixed(2)),RampUp_Latency:parseFloat(rampUpLatency.toFixed(3)),Correctness:parseFloat(correctness.toFixed(2)),Correctness_Latency:parseFloat(correctnessLatency.toFixed(3)),BusFactor:parseFloat(busFactor.toFixed(2)),BusFactor_Latency:parseFloat(busFactorLatency.toFixed(3)),ResponsiveMaintainer:parseFloat(responsiveMaintainerScore.toFixed(2)),ResponsiveMaintainer_Latency:parseFloat(responsiveMaintainerLatency.toFixed(3)),License:parseFloat(licenseScore.toFixed(2)),License_Latency:parseFloat(licenseLatency.toFixed(3))}}}__name(calculateNetScore,\"calculateNetScore\");async function calculateWithLatency(calculateFn){const startTime=Date.now();try{const score=await calculateFn();const endTime=Date.now();const latency=(endTime-startTime)/1e3;return{score,latency}}catch(error){logger.info(`Error calculating score: ${error}`);const endTime=Date.now();const latency=(endTime-startTime)/1e3;return{score:0,latency}}}__name(calculateWithLatency,\"calculateWithLatency\");0&&(module.exports={calculateNetScore});\n})()\n","warnings":[],"map":{"version":3,"mappings":";mvBAAA,2IAGA,mBAAsC,qBACtC,kBAAqC,oBACrC,gCAAmD,kCACnD,uBAAqC,yBACrC,sBAA4C,yBAC5C,qBAAwC,uBACxC,kBAA0B,qBAC1B,gBAA0B,gBAC1B,yBAAqB,yBACrB,IAAAA,aAA0B,mBAE1B,MAAM,UAAS,yBAAU,EAOzB,eAAsB,kBAAkB,SAAmB,SAAyC,CAClG,IAAI,QAAe,CAAC,EACpB,GAAI,SAAU,CACZ,QAAU,QAAM,+BAAY,QAAQ,CACtC,SACS,SAAU,CACjB,QAAU,CAAC,CAAE,YAAa,SAAS,KAAO,MAAO,SAAS,MAAO,IAAK,SAAS,GAAI,CAAC,CACtF,CAEA,SAAW,CAAE,YAAa,MAAO,GAAI,IAAK,QAAS,CACjD,MAAM,SAAW,KAAK,IAAI,EAC1B,MAAM,QAAU,QAAM,wBAAU,sBAAsB,KAAK,IAAI,WAAW,OAAQ,WAAW,EAE7F,IAAI,sBAAwB,EAC5B,IAAI,eAAiB,EACrB,GAAI,QAAS,CACX,GAAI,CACF,MAAM,aAAY,uBAAU,yBAAI,EAChC,KAAM,CAAE,MAAO,EAAI,MAAM,UAAU,mBAAmB,OAAO,EAAE,EAC/D,MAAM,SAAW,KAAK,MAAM,MAAM,EAClC,MAAM,QAAU,SAAS,YAAY,MAAQ,EAC7C,MAAM,QAAU,SAAS,YAAY,MAAQ,EAC7C,sBAAwB,QAAU,QAClC,eAAiB,SAAS,KAAK,MAAQ,CACzC,OAAS,MAAO,CACd,OAAO,KAAK,oCAAoC,KAAK,EAAE,CACzD,CACF,CAEA,KAAM,CAAC,mBAAoB,kBAAmB,gCAAiC,gBAAiB,iBAAiB,EAC/G,MAAM,QAAQ,IAAI,CAChB,qBAAqB,OAAM,sCAAsB,MAAO,YAAa,OAAO,CAAC,EAC7E,qBAAqB,OAAM,oCAAqB,MAAO,YAAa,QAAS,cAAc,CAAC,EAC5F,qBAAqB,OAAM,gEAAmC,MAAO,WAAW,CAAC,EACjF,qBAAqB,OAAM,0CAAwB,MAAO,WAAW,CAAC,EACtE,qBAAqB,OAAM,yCAAqB,QAAS,qBAAqB,CAAC,CACjF,CAAC,EAEH,KAAM,CAAE,MAAO,aAAc,QAAS,cAAe,EAAI,mBACzD,KAAM,CAAE,MAAO,YAAa,QAAS,aAAc,EAAI,kBACvD,KAAM,CAAE,MAAO,0BAA2B,QAAS,2BAA4B,EAAI,gCACnF,KAAM,CAAE,MAAO,UAAW,QAAS,gBAAiB,EAAI,gBACxD,KAAM,CAAE,MAAO,YAAa,QAAS,kBAAmB,EAAI,kBAC5D,MAAM,SACJ,GAAM,aAAe,GAAM,YAAc,IAAO,0BAA4B,IAAO,UAAY,GAAM,YAEvG,MAAM,OAAS,KAAK,IAAI,EACxB,MAAM,YAAc,OAAS,UAAY,IAEzC,OAAO,QACL,KAAK,UAAU,CACb,IAAK,IAAI,KAAK,EACd,SAAU,WAAW,SAAS,QAAQ,CAAC,CAAC,EACxC,iBAAkB,WAAW,WAAW,QAAQ,CAAC,CAAC,EAClD,OAAQ,WAAW,YAAY,QAAQ,CAAC,CAAC,EACzC,eAAgB,WAAW,cAAc,QAAQ,CAAC,CAAC,EACnD,YAAa,WAAW,YAAY,QAAQ,CAAC,CAAC,EAC9C,oBAAqB,WAAW,mBAAmB,QAAQ,CAAC,CAAC,EAC7D,UAAW,WAAW,UAAU,QAAQ,CAAC,CAAC,EAC1C,kBAAmB,WAAW,iBAAiB,QAAQ,CAAC,CAAC,EACzD,qBAAsB,WAAW,0BAA0B,QAAQ,CAAC,CAAC,EACrE,6BAA8B,WAAW,4BAA4B,QAAQ,CAAC,CAAC,EAC/E,QAAS,WAAW,aAAa,QAAQ,CAAC,CAAC,EAC3C,gBAAiB,WAAW,eAAe,QAAQ,CAAC,CAAC,CACvD,CAAC,CACH,EACA,MAAO,CACL,IAAK,IAAI,KAAK,EACd,SAAU,WAAW,SAAS,QAAQ,CAAC,CAAC,EACxC,iBAAkB,WAAW,WAAW,QAAQ,CAAC,CAAC,EAClD,OAAQ,WAAW,YAAY,QAAQ,CAAC,CAAC,EACzC,eAAgB,WAAW,cAAc,QAAQ,CAAC,CAAC,EACnD,YAAa,WAAW,YAAY,QAAQ,CAAC,CAAC,EAC9C,oBAAqB,WAAW,mBAAmB,QAAQ,CAAC,CAAC,EAC7D,UAAW,WAAW,UAAU,QAAQ,CAAC,CAAC,EAC1C,kBAAmB,WAAW,iBAAiB,QAAQ,CAAC,CAAC,EACzD,qBAAsB,WAAW,0BAA0B,QAAQ,CAAC,CAAC,EACrE,6BAA8B,WAAW,4BAA4B,QAAQ,CAAC,CAAC,EAC/E,QAAS,WAAW,aAAa,QAAQ,CAAC,CAAC,EAC3C,gBAAiB,WAAW,eAAe,QAAQ,CAAC,CAAC,CACvD,CACF,CACF,CAlFsB,8CAyFtB,eAAe,qBAAqB,YAAiF,CACnH,MAAM,UAAY,KAAK,IAAI,EAC3B,GAAI,CACF,MAAM,MAAQ,MAAM,YAAY,EAChC,MAAM,QAAU,KAAK,IAAI,EACzB,MAAM,SAAW,QAAU,WAAa,IACxC,MAAO,CAAE,MAAO,OAAQ,CAC1B,OAAS,MAAO,CACd,OAAO,KAAK,4BAA4B,KAAK,EAAE,EAC/C,MAAM,QAAU,KAAK,IAAI,EACzB,MAAM,SAAW,QAAU,WAAa,IACxC,MAAO,CAAE,MAAO,EAAG,OAAiB,CACtC,CACF,CAbe","names":["import_util"],"ignoreList":[],"sources":["D:\\Purdue\\s1\\46100\\local\\ECE461-group32\\backend\\src\\rating\\metrics\\netScore.ts"],"sourcesContent":[null]}}