{"code":"(()=>{\n\"use strict\";var __create=Object.create;var __defProp=Object.defineProperty;var __getOwnPropDesc=Object.getOwnPropertyDescriptor;var __getOwnPropNames=Object.getOwnPropertyNames;var __getProtoOf=Object.getPrototypeOf;var __hasOwnProp=Object.prototype.hasOwnProperty;var __name=(target,value)=>__defProp(target,\"name\",{value,configurable:true});var __export=(target,all)=>{for(var name in all)__defProp(target,name,{get:all[name],enumerable:true})};var __copyProps=(to,from,except,desc)=>{if(from&&typeof from===\"object\"||typeof from===\"function\"){for(let key of __getOwnPropNames(from))if(!__hasOwnProp.call(to,key)&&key!==except)__defProp(to,key,{get:()=>from[key],enumerable:!(desc=__getOwnPropDesc(from,key))||desc.enumerable})}return to};var __toESM=(mod,isNodeMode,target)=>(target=mod!=null?__create(__getProtoOf(mod)):{},__copyProps(isNodeMode||!mod||!mod.__esModule?__defProp(target,\"default\",{value:mod,enumerable:true}):target,mod));var __toCommonJS=mod=>__copyProps(__defProp({},\"__esModule\",{value:true}),mod);var license_exports={};__export(license_exports,{calculateLicenseScore:()=>calculateLicenseScore});module.exports=__toCommonJS(license_exports);var import_graphqlClient=require(\"../graphqlClient\");var import_logger=require(\"../logger\");var import_path=__toESM(require(\"path\"));var import_promises=require(\"fs/promises\");const logger=(0,import_logger.getLogger)();const Licenses=new Set([\"MIT\",\"Apache-2.0\",\"ISC\",\"BSD-2-Clause\",\"BSD-3-Clause\",\"0BSD\",\"Academic Free License v3.0\",\"AFL-3.0\",\"Artistic License 2.0\",\"Artistic-2.0\",\"Boost Software License 1.0\",\"BSL-1.0\",\"BSD-4-Clause\",\"BSD-3-Clause-Clear\",\"Creative Commons license family\",\"CC\",\"Creative Commons Zero v1.0 Universal\",\"CC0-1.0\",\"Creative Commons Attribution 4.0\",\"CC-BY-4.0\",\"Creative Commons Attribution ShareAlike 4.0\",\"CC-BY-SA-4.0\",\"Do What The F*ck You Want To Public License\",\"WTFPL\",\"Educational Community License v2.0\",\"ECL-2.0\",\"Eclipse Public License 1.0\",\"EPL-1.0\",\"Eclipse Public License 2.0\",\"EPL-2.0\",\"European Union Public License 1.1\",\"EUPL-1.1\",\"GNU Affero General Public License v3.0\",\"AGPL-3.0\",\"GNU General Public License v2.0\",\"GPL-2.0\",\"GNU General Public License v3.0\",\"GPL-3.0\",\"GNU Lesser General Public License v2.1\",\"LGPL-2.1\",\"GNU Lesser General Public License v3.0\",\"LGPL-3.0\",\"LaTeX Project Public License v1.3c\",\"LPPL-1.3c\",\"Microsoft Public License\",\"MS-PL\",\"Mozilla Public License 2.0\",\"MPL-2.0\",\"Open Software License 3.0\",\"OSL-3.0\",\"PostgreSQL License\",\"PostgreSQL\",\"SIL Open Font License 1.1\",\"OFL-1.1\",\"University of Illinois/NCSA Open Source License\",\"NCSA\",\"The Unlicense\",\"Zlib\",\"zLib License\"]);async function fetchLicenseFromGraphQL(repoOwner,repoName){try{const data=await import_graphqlClient.graphqlClient.request(import_graphqlClient.GET_VALUES_FOR_LICENSE,{repoOwner,repoName});const restLicense=data.repository.licenseInfo.spdxId;logger.debug(\"restLicense: \",restLicense);return Licenses.has(restLicense)?restLicense:null}catch(error){logger.info(\"Error retrieving license information:\",error);return null}}__name(fetchLicenseFromGraphQL,\"fetchLicenseFromGraphQL\");async function fetchLicenseFromReadme(repoDir){try{const readmePath=import_path.default.join(repoDir,\"README.md\");const readmeContent=await(0,import_promises.readFile)(readmePath,\"utf8\");for(const licenseName of Licenses){if(new RegExp(`\\\\b${licenseName}\\\\b`,\"i\").test(readmeContent)){return licenseName}}return null}catch(readError){logger.info(`README.md not found or could not be read: ${readError}`);return null}}__name(fetchLicenseFromReadme,\"fetchLicenseFromReadme\");async function fetchLicenseFromPackageJson(repoDir){try{const packageJsonPath=import_path.default.join(repoDir,\"package.json\");const packageJson=await(0,import_promises.readFile)(packageJsonPath,\"utf8\");const packageJsonObj=JSON.parse(packageJson);const license=packageJsonObj.license;return Licenses.has(license)?license:null}catch(readError){logger.info(`package.json not found or could not be read: ${readError}`);return null}}__name(fetchLicenseFromPackageJson,\"fetchLicenseFromPackageJson\");async function calculateLicenseScore(repoOwner,repoName,repoDir){const restLicense=await fetchLicenseFromGraphQL(repoOwner,repoName);if(restLicense){logger.info(\"License found in GraphQL\");return 1}if(!repoDir){logger.info(\"Could not calculate license score: No repository directory provided\");return 0}const readmeLicense=await fetchLicenseFromReadme(repoDir);if(readmeLicense){logger.info(\"License found in README.md\");return 1}const packageJsonLicense=await fetchLicenseFromPackageJson(repoDir);if(packageJsonLicense){logger.info(\"License found in package.json\");return 1}logger.info(\"No license found\");return 0}__name(calculateLicenseScore,\"calculateLicenseScore\");0&&(module.exports={calculateLicenseScore});\n})()\n","warnings":[],"map":{"version":3,"mappings":";8/BAAA,gJAGA,yBAAsD,4BAEtD,kBAA0B,qBAC1B,gBAAiB,yBACjB,oBAAyB,uBAEzB,MAAM,UAAS,yBAAU,EAEzB,MAAM,SAAW,IAAI,IAAI,CACvB,MACA,aACA,MACA,eACA,eACA,OACA,6BACA,UACA,uBACA,eACA,6BACA,UACA,eACA,qBACA,kCACA,KACA,uCACA,UACA,mCACA,YACA,8CACA,eACA,8CACA,QACA,qCACA,UACA,6BACA,UACA,6BACA,UACA,oCACA,WACA,yCACA,WACA,kCACA,UACA,kCACA,UACA,yCACA,WACA,yCACA,WACA,qCACA,YACA,2BACA,QACA,6BACA,UACA,4BACA,UACA,qBACA,aACA,4BACA,UACA,kDACA,OACA,gBACA,OACA,cACF,CAAC,EAQD,eAAe,wBAAwB,UAAmB,SAA0C,CAClG,GAAI,CACF,MAAM,KAAuB,MAAM,mCAAc,QAAQ,4CAAwB,CAC/E,UACA,QACF,CAAC,EAED,MAAM,YAAc,KAAK,WAAW,YAAY,OAChD,OAAO,MAAM,gBAAiB,WAAW,EAEzC,OAAO,SAAS,IAAI,WAAW,EAAI,YAAc,IACnD,OAAS,MAAO,CACd,OAAO,KAAK,wCAAyC,KAAK,EAC1D,OAAO,IACT,CACF,CAfe,0DAsBf,eAAe,uBAAuB,QAAyC,CAC7E,GAAI,CACF,MAAM,WAAa,YAAAA,QAAK,KAAK,QAAS,WAAW,EAEjD,MAAM,cAAgB,QAAM,0BAAS,WAAY,MAAM,EAEvD,UAAW,eAAe,SAAU,CAElC,GAAI,IAAI,OAAO,MAAM,WAAW,MAAO,GAAG,EAAE,KAAK,aAAa,EAAG,CAC/D,OAAO,WACT,CACF,CAEA,OAAO,IACT,OAAS,UAAW,CAClB,OAAO,KAAK,6CAA6C,SAAS,EAAE,EACpE,OAAO,IACT,CACF,CAlBe,wDAyBf,eAAe,4BAA4B,QAAyC,CAClF,GAAI,CACF,MAAM,gBAAkB,YAAAA,QAAK,KAAK,QAAS,cAAc,EAEzD,MAAM,YAAc,QAAM,0BAAS,gBAAiB,MAAM,EAC1D,MAAM,eAAiB,KAAK,MAAM,WAAW,EAC7C,MAAM,QAAU,eAAe,QAC/B,OAAO,SAAS,IAAI,OAAO,EAAI,QAAU,IAC3C,OAAS,UAAW,CAClB,OAAO,KAAK,gDAAgD,SAAS,EAAE,EACvE,OAAO,IACT,CACF,CAZe,kEAqBf,eAAsB,sBACpB,UACA,SACA,QACiB,CACjB,MAAM,YAAc,MAAM,wBAAwB,UAAW,QAAQ,EACrE,GAAI,YAAa,CACf,OAAO,KAAK,0BAA0B,EACtC,MAAO,EACT,CAEA,GAAI,CAAC,QAAS,CACZ,OAAO,KAAK,qEAAqE,EACjF,MAAO,EACT,CAEA,MAAM,cAAgB,MAAM,uBAAuB,OAAO,EAC1D,GAAI,cAAe,CACjB,OAAO,KAAK,4BAA4B,EACxC,MAAO,EACT,CAEA,MAAM,mBAAqB,MAAM,4BAA4B,OAAO,EACpE,GAAI,mBAAoB,CACtB,OAAO,KAAK,+BAA+B,EAC3C,MAAO,EACT,CACA,OAAO,KAAK,kBAAkB,EAC9B,MAAO,EACT,CA7BsB","names":["path"],"ignoreList":[],"sources":["D:\\Purdue\\s1\\46100\\local\\ECE461-group32\\backend\\src\\rating\\metrics\\license.ts"],"sourcesContent":[null]}}