{"code":"(()=>{\n\"use strict\";var __create=Object.create;var __defProp=Object.defineProperty;var __getOwnPropDesc=Object.getOwnPropertyDescriptor;var __getOwnPropNames=Object.getOwnPropertyNames;var __getProtoOf=Object.getPrototypeOf;var __hasOwnProp=Object.prototype.hasOwnProperty;var __name=(target,value)=>__defProp(target,\"name\",{value,configurable:true});var __export=(target,all)=>{for(var name in all)__defProp(target,name,{get:all[name],enumerable:true})};var __copyProps=(to,from,except,desc)=>{if(from&&typeof from===\"object\"||typeof from===\"function\"){for(let key of __getOwnPropNames(from))if(!__hasOwnProp.call(to,key)&&key!==except)__defProp(to,key,{get:()=>from[key],enumerable:!(desc=__getOwnPropDesc(from,key))||desc.enumerable})}return to};var __toESM=(mod,isNodeMode,target)=>(target=mod!=null?__create(__getProtoOf(mod)):{},__copyProps(isNodeMode||!mod||!mod.__esModule?__defProp(target,\"default\",{value:mod,enumerable:true}):target,mod));var __toCommonJS=mod=>__copyProps(__defProp({},\"__esModule\",{value:true}),mod);var logger_exports={};__export(logger_exports,{getLogger:()=>getLogger,logTestResults:()=>logTestResults,reinitializeLogger:()=>reinitializeLogger});module.exports=__toCommonJS(logger_exports);var import_winston=__toESM(require(\"winston\"));var import_path=__toESM(require(\"path\"));var import_promises=require(\"fs/promises\");var import_child_process=require(\"child_process\");var import_util=require(\"util\");var import_config=require(\"dotenv/config\");let bareLogger=null;const initializeLogger=__name(()=>{const logLevel=(()=>{const level=process.env.LOG_LEVEL;switch(level){case\"1\":return\"info\";case\"2\":return\"debug\";default:return\"silent\"}})();const fileLogFormat=import_winston.default.format.combine(import_winston.default.format.timestamp({format:\"DD/MM/YYYY HH:mm:ss\"}),import_winston.default.format.printf(({timestamp,level,message})=>{if(typeof message===\"object\"){message=JSON.stringify(message,null,2)}return`${timestamp} [${level}]: ${message}`}));const logDir=process.env.LOG_FILE||\"logs/log.txt\";bareLogger=import_winston.default.createLogger({level:logLevel,format:fileLogFormat,transports:[new import_winston.default.transports.File({filename:logDir})],silent:logLevel===\"silent\"});bareLogger.console=message=>{console.log(message);if(logLevel===\"info\"||logLevel===\"debug\"){bareLogger.info(message)}}},\"initializeLogger\");const getLogger=__name(()=>{if(!bareLogger){initializeLogger();if(!bareLogger){throw new Error(\"Unable to initialize logger\")}}return bareLogger},\"getLogger\");const reinitializeLogger=__name(()=>{bareLogger=null;initializeLogger();if(!bareLogger){throw new Error(\"Unable to reinitialize logger\")}},\"reinitializeLogger\");const logTestResults=__name(async()=>{const logger=getLogger();const __dirname=import_path.default.dirname(__filename);const asyncExec=(0,import_util.promisify)(import_child_process.exec);const command=process.env.NODE_ENV===\"test\"?\"npx vitest run --coverage --coverage.reportsDirectory=./logCoverage --reporter=json --outputFile=logCoverage/test-results.json --exclude src/__tests__/index.test.ts\":\"npx vitest run --coverage --coverage.reportsDirectory=./logCoverage1 --reporter=json --outputFile=logCoverage1/test-results.json\";try{try{const{stdout,stderr}=await asyncExec(command);if(stderr){logger.debug(`Error running tests: ${stderr} ${stdout}`)}}catch(error){logger.debug(error)}const file=await(0,import_promises.readFile)(import_path.default.resolve(__dirname,\"..\",process.env.NODE_ENV===\"test\"?\"logCoverage\":\"logCoverage1\",\"test-results.json\"),\"utf-8\");const results=JSON.parse(file);const totalTests=results.numTotalTests;const totalPassed=results.numPassedTests;const coverageSummary=await(0,import_promises.readFile)(import_path.default.resolve(__dirname,\"..\",process.env.NODE_ENV===\"test\"?\"logCoverage\":\"logCoverage1\",\"coverage-summary.json\"),\"utf-8\");const coverage=JSON.parse(coverageSummary);const lineCoverage=parseInt(coverage.total.lines.pct);logger.console(`Total: ${totalTests}`);logger.console(`Passed: ${totalPassed}`);logger.console(`Coverage: ${lineCoverage}%`);logger.console(`${totalPassed}/${totalTests} test cases passed. ${lineCoverage}% line coverage achieved.`)}catch(error){logger.debug(error);throw error}},\"logTestResults\");0&&(module.exports={getLogger,logTestResults,reinitializeLogger});\n})()\n","warnings":[],"map":{"version":3,"mappings":";8/BAAA,iMAGA,mBAAoB,4BACpB,gBAAiB,yBACjB,oBAAyB,uBAEzB,yBAAqB,yBACrB,gBAA0B,gBAC1B,kBAAO,yBAQP,IAAI,WAAkC,KAKtC,MAAM,iBAAmB,WAAM,CAC7B,MAAM,UAAY,IAAM,CACtB,MAAM,MAAQ,QAAQ,IAAI,UAC1B,OAAQ,MAAO,CACb,IAAK,IACH,MAAO,OACT,IAAK,IACH,MAAO,QACT,QACE,MAAO,QACX,CACF,GAAG,EAEH,MAAM,cAAgB,eAAAA,QAAQ,OAAO,QACnC,eAAAA,QAAQ,OAAO,UAAU,CAAE,OAAQ,qBAAsB,CAAC,EAC1D,eAAAA,QAAQ,OAAO,OAAO,CAAC,CAAE,UAAW,MAAO,OAAQ,IAAM,CACvD,GAAI,OAAO,UAAY,SAAU,CAC/B,QAAU,KAAK,UAAU,QAAS,KAAM,CAAC,CAC3C,CACA,MAAO,GAAG,SAAS,KAAK,KAAK,MAAM,OAAO,EAC5C,CAAC,CACH,EAEA,MAAM,OAAS,QAAQ,IAAI,UAAY,eAGvC,WAAa,eAAAA,QAAQ,aAAa,CAChC,MAAO,SACP,OAAQ,cACR,WAAY,CAAC,IAAI,eAAAA,QAAQ,WAAW,KAAK,CAAE,SAAU,MAAO,CAAC,CAAC,EAC9D,OAAQ,WAAa,QACvB,CAAC,EAGD,WAAW,QAAW,SAAoB,CACxC,QAAQ,IAAI,OAAO,EACnB,GAAI,WAAa,QAAU,WAAa,QAAS,CAC/C,WAAY,KAAK,OAAO,CAC1B,CACF,CACF,EAxCyB,oBA8ClB,MAAM,UAAY,WAAM,CAC7B,GAAI,CAAC,WAAY,CACf,iBAAiB,EACjB,GAAI,CAAC,WAAY,CACf,MAAM,IAAI,MAAM,6BAA6B,CAC/C,CACF,CACA,OAAO,UACT,EARyB,aAalB,MAAM,mBAAqB,WAAM,CACtC,WAAa,KACb,iBAAiB,EACjB,GAAI,CAAC,WAAY,CACf,MAAM,IAAI,MAAM,+BAA+B,CACjD,CACF,EANkC,sBAW3B,MAAM,eAAiB,gBAAY,CACxC,MAAM,OAAS,UAAU,EACzB,MAAM,UAAY,YAAAC,QAAK,QAAQ,UAAU,EACzC,MAAM,aAAY,uBAAU,yBAAI,EAEhC,MAAM,QACJ,QAAQ,IAAI,WAAa,OACrB,uKACA,mIACN,GAAI,CACF,GAAI,CACF,KAAM,CAAE,OAAQ,MAAO,EAAI,MAAM,UAAU,OAAO,EAClD,GAAI,OAAQ,CACV,OAAO,MAAM,wBAAwB,MAAM,IAAI,MAAM,EAAE,CACzD,CACF,OAAS,MAAO,CACd,OAAO,MAAM,KAAK,CACpB,CAEA,MAAM,KAAO,QAAM,0BACjB,YAAAA,QAAK,QACH,UACA,KACA,QAAQ,IAAI,WAAa,OAAS,cAAgB,eAClD,mBACF,EACA,OACF,EACA,MAAM,QAAU,KAAK,MAAM,IAAI,EAC/B,MAAM,WAAa,QAAQ,cAC3B,MAAM,YAAc,QAAQ,eAE5B,MAAM,gBAAkB,QAAM,0BAC5B,YAAAA,QAAK,QACH,UACA,KACA,QAAQ,IAAI,WAAa,OAAS,cAAgB,eAClD,uBACF,EACA,OACF,EACA,MAAM,SAAW,KAAK,MAAM,eAAe,EAC3C,MAAM,aAAe,SAAS,SAAS,MAAM,MAAM,GAAG,EACtD,OAAO,QAAQ,UAAU,UAAU,EAAE,EACrC,OAAO,QAAQ,WAAW,WAAW,EAAE,EACvC,OAAO,QAAQ,aAAa,YAAY,GAAG,EAC3C,OAAO,QAAQ,GAAG,WAAW,IAAI,UAAU,uBAAuB,YAAY,2BAA2B,CAC3G,OAAS,MAAO,CACd,OAAO,MAAM,KAAK,EAClB,MAAM,KACR,CACF,EAnD8B","names":["winston","path"],"ignoreList":[],"sources":["D:\\Purdue\\s1\\46100\\local\\ECE461-group32\\backend\\src\\rating\\logger.ts"],"sourcesContent":[null]}}