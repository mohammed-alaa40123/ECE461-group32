{"code":"(()=>{\n\"use strict\";var __defProp=Object.defineProperty;var __getOwnPropDesc=Object.getOwnPropertyDescriptor;var __getOwnPropNames=Object.getOwnPropertyNames;var __hasOwnProp=Object.prototype.hasOwnProperty;var __name=(target,value)=>__defProp(target,\"name\",{value,configurable:true});var __export=(target,all)=>{for(var name in all)__defProp(target,name,{get:all[name],enumerable:true})};var __copyProps=(to,from,except,desc)=>{if(from&&typeof from===\"object\"||typeof from===\"function\"){for(let key of __getOwnPropNames(from))if(!__hasOwnProp.call(to,key)&&key!==except)__defProp(to,key,{get:()=>from[key],enumerable:!(desc=__getOwnPropDesc(from,key))||desc.enumerable})}return to};var __toCommonJS=mod=>__copyProps(__defProp({},\"__esModule\",{value:true}),mod);var rampUp_exports={};__export(rampUp_exports,{calculateRampUpScore:()=>calculateRampUpScore});module.exports=__toCommonJS(rampUp_exports);var import_graphqlClient=require(\"../graphqlClient\");var import_date_fns=require(\"date-fns\");var import_logger=require(\"../logger\");const logger=(0,import_logger.getLogger)();async function calculateRampUpScore(repoOwner,repoName,repoDir,loc,firstForks=50){try{const data=await import_graphqlClient.graphqlClient.request(import_graphqlClient.GET_VALUES_FOR_RAMP_UP,{repoOwner,repoName,firstForks});const averageDays=await calculateAverageDaysToFirstActivity(data);const documentationWeight=await calculateDocumentationWeight(data,repoOwner,repoName);const targetTime=repoDir?await calculateTargetTime(repoDir,loc):21;const constant=targetTime/Math.log(1.05);const averageTimeValue=Math.max(Math.exp(-(averageDays-targetTime)/constant),.3);const score=Math.min(1,averageTimeValue*documentationWeight);logger.debug(`Parts of the Ramp Up score: Main part: ${averageTimeValue}, Constant: ${constant}, Documentation Weight: ${documentationWeight}, Target Time: ${targetTime}`);logger.debug(`Ramp Up score for ${repoOwner}/${repoName}: ${score}`);return score}catch(error){logger.info(\"Error fetching forks and PRs:\",error);return 0}}__name(calculateRampUpScore,\"calculateRampUpScore\");async function calculateAverageDaysToFirstActivity(data){let totalDays=0;let forksWithActivity=0;data.repository.forks.edges.forEach(({node:fork})=>{const forkCreatedAt=new Date(fork.createdAt);const firstPRDate=fork.pullRequests.nodes.length>0?new Date(fork.pullRequests.nodes[0].createdAt):null;const firstIssueDate=fork.issues.nodes.length>0?new Date(fork.issues.nodes[0].createdAt):null;const firstCommitDate=fork.refs.nodes.length>0?new Date(fork.refs.nodes[0].target.history.edges[0].node.committedDate):null;const validActivityDates=[firstCommitDate,firstPRDate,firstIssueDate].filter(date=>date&&date>=forkCreatedAt);const firstActivityDate=validActivityDates.filter(Boolean).reduce((earliest,current)=>current&&(!earliest||current<earliest)?current:earliest,null);if(firstActivityDate){const daysBetween=(0,import_date_fns.differenceInDays)(firstActivityDate,forkCreatedAt);totalDays+=daysBetween;forksWithActivity++}});logger.debug(`Total days: ${totalDays}, Forks with activity: ${forksWithActivity}`);return forksWithActivity>0?totalDays/forksWithActivity:0}__name(calculateAverageDaysToFirstActivity,\"calculateAverageDaysToFirstActivity\");async function calculateDocumentationWeight(data,repoOwner,repoName){const readme=data.repository.object;const contributing=data.repository.contributing;if(readme&&contributing){logger.debug(`Found README and CONTRIBUTING for repo ${repoOwner}/${repoName}`);return 1}else if(readme||contributing){logger.debug(`Found README or CONTRIBUTING for repo ${repoOwner}/${repoName}`);return .9}else{logger.debug(`No README or CONTRIBUTING found for repo ${repoOwner}/${repoName}`);return .8}}__name(calculateDocumentationWeight,\"calculateDocumentationWeight\");async function calculateTargetTime(repoDir,loc){try{logger.debug(`Lines of code: ${loc}`);if(loc<=5e3){return 7}else if(loc<=1e4){return 10}else if(loc<=5e4){return 14}else if(loc<=1e5){return 21}else if(loc<=5e5){return 30}else if(loc<=1e6){return 45}else{return 60}}catch(error){logger.info(\"Error calculating target time:\",error)}return 21}__name(calculateTargetTime,\"calculateTargetTime\");0&&(module.exports={calculateRampUpScore});\n})()\n","warnings":[],"map":{"version":3,"mappings":"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","names":[],"ignoreList":[],"sources":["D:\\Purdue\\s1\\46100\\local\\ECE461-group32\\backend\\src\\rating\\metrics\\rampUp.ts"],"sourcesContent":[null]}}